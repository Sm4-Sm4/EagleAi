<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Eagle Terminal</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { background: #000; color: #00ff88; font-family: "Source Code Pro", monospace; overflow: hidden; }
#mainContainer { display:flex; width:100vw; height:100vh; }
#sidebar { width:280px; background: linear-gradient(180deg,#111,#0a0a0a); border-right:1px solid #222; padding:16px; display:flex; flex-direction:column; justify-content:space-between; }
#sidebar .btn { width:100%; padding:6px 10px; background:transparent; color:#23D200; border:1px solid #23D200; border-radius:2px; font-weight:bold; text-align:center; cursor:pointer; margin-bottom:6px; font-size:1rem; transition: background 0.2s, color 0.2s; }
#sidebar .btn:hover { background:#00ff88; color:#000; }
#chatContainer { flex:1; display:flex; flex-direction:column; padding:16px; background:#000; border-left:1px solid #222; overflow-y:auto; font-family: "Source Code Pro", monospace; font-size:18px; }
.terminal-line { display:flex; flex-wrap:wrap; width:100%; }
.prompt { color:#23D200; user-select:none; flex-shrink:0; width:140px; font-size:18px; }
.input-wrapper { display:flex; flex-wrap:wrap; white-space:pre-wrap; word-break:break-word; flex:1; font-size:18px; }
.input-text { color:#23D200; }
.cursor { color:#23D200; animation:blink 1s steps(1) infinite; }
@keyframes blink { 50% { opacity:0; } }
.msg-ai, .msg-error { color:#fff; white-space:pre-wrap; word-break:break-word; font-size:18px; display:flex; }
.msg-ai::before, .msg-error::before { content:""; display:inline-block; width:140px; flex-shrink:0; }
.msg-error { color:#f92672; }
</style>
</head>
<body>
<div id="mainContainer">
  <div id="sidebar">
    <div class="flex flex-col">
      <button id="btnProfile" class="btn">Profile</button>
      <button id="btnNewChat" class="btn">New Chat</button>
      <div id="conversationList"></div>
    </div>
    <a href="https://t.me/+DKNhCjWNY4A2NmQx" target="_blank" class="btn mt-4">Rejoindre Telegram</a>
  </div>
  <div id="chatContainer"></div>
</div>

<script>
// ------------------------------
// PROTECTION + BYPASS "dimitri"
// ------------------------------
const user = localStorage.getItem("user");
if(!user){
  const bypass = prompt("Entrez votre identifiant pour accéder au terminal :");
  if(bypass === "dimitri"){ localStorage.setItem("user","bypass-dimitri"); alert("Accès autorisé."); }
  else { window.location.href = "./index.html"; }
}

// ------------------------------
// Redirection boutons
// ------------------------------
document.getElementById("btnProfile").addEventListener("click",()=>{window.location.href="./404.html";});
document.getElementById("btnNewChat").addEventListener("click",()=>{window.location.href="./terminal.html";});

// ------------------------------
// Terminal IA simulation
// ------------------------------
const chatContainer = document.getElementById("chatContainer");
let lastRequestTime = 0;
const COOLDOWN = 1500;

function createInputLine(){
  const line = document.createElement("div"); line.className="terminal-line";
  const prompt = document.createElement("span"); prompt.className="prompt"; prompt.textContent="user@eagle:~$ ";
  const inputWrapper = document.createElement("span"); inputWrapper.className="input-wrapper";
  const inputText = document.createElement("span"); inputText.className="input-text";
  const cursor = document.createElement("span"); cursor.className="cursor"; cursor.textContent="_";
  inputWrapper.appendChild(inputText); inputWrapper.appendChild(cursor);
  line.appendChild(prompt); line.appendChild(inputWrapper);
  chatContainer.appendChild(line); chatContainer.scrollTop=chatContainer.scrollHeight;
  let inputValue="";
  document.addEventListener("keydown", function handler(e){
    if(e.key==="Backspace"){ inputValue=inputValue.slice(0,-1); inputText.textContent=inputValue; e.preventDefault(); }
    else if(e.key==="Enter"){ e.preventDefault(); const now=Date.now(); if(now-lastRequestTime<COOLDOWN) return; if(!inputValue) return; lastRequestTime=now; document.removeEventListener("keydown",handler); cursor.remove(); typeAIMessage(inputValue).then(()=>createInputLine()); inputValue=""; }
    else if(e.key.length===1){ inputValue+=e.key; inputText.textContent=inputValue; chatContainer.scrollTop=chatContainer.scrollHeight; }
  });
}

async function typeAIMessage(userMsg){
  const div=document.createElement("div"); div.className="msg-ai"; chatContainer.appendChild(div); chatContainer.scrollTop=chatContainer.scrollHeight;
  const thinking=document.createElement("span"); thinking.textContent="eagle réfléchit : 0 ms"; div.appendChild(thinking);
  let startTime=Date.now();
  const interval=setInterval(()=>{ const elapsed=Date.now()-startTime; thinking.textContent=`eagle réfléchit : ${elapsed} ms`; chatContainer.scrollTop=chatContainer.scrollHeight; },50);
  try{
    await new Promise(r=>setTimeout(r,500)); // simulation
    clearInterval(interval); thinking.remove();
    div.textContent="Réponse simulée de l'IA : Bonjour !";
  }catch{
    clearInterval(interval); thinking.remove(); div.className="msg-error"; div.textContent="Erreur : impossible de contacter l’IA.";
  }
}

createInputLine();
</script>
</body>
</html>
